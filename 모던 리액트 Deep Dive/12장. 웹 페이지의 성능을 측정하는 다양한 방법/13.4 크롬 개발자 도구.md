# 13.4 크롬 개발자 도구

- 웹 사이트의 성능 이슈를 파악하기 위해 크롬 브라우저에서 제공하는 기능
- 확장 프로그램 등의 영향으로 성능이 왜곡될 수 있어 시크릿 창으로 웹 사이트를 여는 것이 좋다.

## 성능 통계(Performance Insights)

- 웨 사이트의 성능을 자세하게 확인할 수 있는 도구
- Page Load: 웹 사이트 로딩 시작부터 끝까지를 측정
- Start Recording: 원하는 액션을 수행하면서 측정
- Throttling: 고의로 네트워크와 CPU 성능을 제한한다. 일반적인 모바일 사용자나 느린 네트워크 환경에서 웹 사이트가 어떻게 동작하는지 확인할 수 있다.
- 반드시 뷰포트를 실제 사용자가 보는 크기만큼 설정해야 한다. 뷰포트가 잘린다면, 잘린만큼만 측정하기 때문에 정확한 결과를 얻을 수 없다.

### Insights

- 시간의 흐름에 따라 발생한 이벤트를 시각적으로 확인할 수 있다.
- 핵심 웹 지표: FCP, LCP, DOMContentLoaded가 언제 발생했는지 확인할 수 있다.
- Performance Measure: User Timing API로 측정한 지표들을 확인할 수 있다.
- Long Task: 오랜 시간이 걸리는 작업을 자세하게 확인하여 어떤 부분이 문제인지 확인할 수 있다.
- Render blocking CSS
  - <head> 내의 스타일은 중요한 것으로 분류되어, 다운로드와 후처리가 끝난 후에 렌더링이 재개된다.
  - 뷰포트에서 필요한 스타일만 존재하는 것이 이상적이다.
  - 중요하지 않은 스타일이라면, rel=preload로 비동기적으로 요청한다.
- Forced Style recalculation: 스타일이 다시 계산되는 작업이 발생했다.

### 메인 메뉴

- 성능을 측정하는 기간 동안 무슨 일이 일어나는지 확인할 수 있는 다양한 기능을 제공한다.
- Layout Shifts: 레이아웃 이동이 일어날 경우 기록
- Network: 발생한 모든 네트워크 요청
- Renderer: 렌더러가 어떤 작업을 하는지 확인. 크기가 크다면 반드시 클릭해보자. Long Task일 가능성이 크다.
- Timing: User Timing API와 관련된 기록

## 성능(Performance)

- 성능 통계(Performance Insights)보다 더 자세한 정보를 세밀하게 확인해볼 수 있다.

### 요약

- 측정 기간의 CPU, 네트워크 요청, 스크린샷, 메모리 점유율 등을 그림으로 확인할 수 있다.
- 드래그를 통해 시점을 선택할 수 있다.

### 네트워크

- 모든 네트워크 요청을 확인할 수 있다.
- 위에 있을수록 우선순위가 높다.
- 막대 그래프
  - 왼쪽 선: TCP 연결이 시작된 시간
  - 연한 막대: 요청을 보내고 최초 바이트가 오기까지의 시간(TTFB)
  - 진한 막대: 최초 바이트에서 마지막 바이트까지의 시간
  - 오른쪽 선: 메인 스레드의 응답을 기다리는 시간
- 진한 막대 영역이 크다면 큰 파일이다.
- 연한 막대 영역이 크다면 다운로드 요청이 느린 것이다.

### Web vitals

- FCP, LCP 등의 시점을 확인할 수 있다.

### 소요 시간과 기본

- 메인 스레드 작업이 어떻게 이루어졌는지를 확인할 수 있다.
- 최적화하기 위해 가장 긴 작업을 선택한다.
- '작업', '스크립트 평가', '마이크로 태스크 실행'은 자바스크립트 엔진과 관련된 내용이다. 해당 함수 아래의 함수를 확인해보자.
- Next.js, Webpack 등이 만든 코드(함수)를 내부로 들어가다보면 우리가 작성한 코드를 발견할 수 있다. 어떤 부분이 오래 걸리는 지 확인해보자.
- 하단 그래프는 시간 순서에 따라 힙의 크기, 노드와 이벤트 리스너의 개수를 표시하는데 성능을 판단하는데 도움이 될 수 있다.
- 소스 맵은 프로덕션에서는 용량을 차지하기도 하고, 소스 코드 유출이 될 수 있으므로 사용하지 않는 편이 좋다.

## 정리

- 성능을 개선하고 애플리케이션에서 병목 지점을 찾는 것은 개발하는 것 이상으로 어려운 일이다.
- 반복적으로 꾸준히 탐색해야만 한다.
- 웹 사이트 성능 개선을 잘 한다면 단순히 리액트 개발자가 아닌 웹 애플리케이션 개발자로 한 단계 성장할 것이다.
- 심지어 이 지식은 트렌드를 타지 않는 노하우로 남을 수 있다.

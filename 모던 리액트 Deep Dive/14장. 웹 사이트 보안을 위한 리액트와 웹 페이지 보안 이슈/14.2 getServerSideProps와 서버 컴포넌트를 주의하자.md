# 14.2 getServersideProps와 서버 컴포넌트를 주의하자

- 서버 사이드 렌더링과 서버 컴포넌트는 성능 이점을 가져다 줌과 동시에, 서버라는 환경을 프론트엔드 개발자에게 제공한 것이다.
- 그래서 서버에서만 사용하는 중요한 개인 정보 등이 프론트엔드에 노출될 수 있는 위첨성이 커졌다.
- 브라우저에 정보를 노출시키지 않게 하기 위해 주의해야 한다.

## Case: cookie를 사용하여 인증하기

1. 서버에서 getServerSideProps를 통해 cookie를 리턴하고, 클라이언트에서 cookie를 검증하고 실패했다면 리다이렉트한다.
   - (1) 사용자의 HTML에 기록되고 (2) 전역 변수로 등록되어 스크립트를 통해 접근할 수 있는 환경이 되기 때문에 보안 위협 요소가 발생한다.
   - gerServerSideProps 리턴 값은 반드시 필요한 값으로만 철저하게 제한되어야 한다.
2. 서버에서 cookie를 검증하고 실패했다면 리다이렉트를 하고, 성공했다면 클라이언트로 token만 제한적으로 리턴한다.
   - 불필요하게 쿠키 값을 노출하지 않았고, 리다이렉트 성능이 개선될 것이다.

## Case: 서버에서 Redux store에 초기 상태 전달

- `window.__PRELOADED_STATE__`: 서버 사이드 렌더링(SSR)을 사용하는 애플리케이션에서 클라이언트 측에 Redux 스토어의 초기 상태를 전달하기 위해 사용하는 전역 객체
- 클라이언트에서는 이 상태를 Redux 스토어에 주입하여 초기화
- 서버에 상태값이 스크립트로써 저장되어 XSS가 발생할 수 있다. 이를 방지하기 위해 이 객체를 사용하기 위해서는 escape 처리를 거치고 필요한 값만 전달해야 한다.
